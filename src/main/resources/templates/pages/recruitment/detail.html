<!-- templates/pages/recruitment/detail.html -->
<html lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layouts/base}">

<head>
    <title layout:fragment="title">채용 공고 상세 정보</title>

    <th:block layout:fragment="head-extra">
        <style>
            .dot-icon {
                display: inline-block;
                width: 6px;
                height: 6px;
                border-radius: 50%;
                background-color: #4e73df;
            }

            .ko-word-wrap {
                word-break: keep-all;
            }

            .table th {
                width: 15%;
                white-space: nowrap;
                background-color: #f8f9fc;
            }

            .table td {
                vertical-align: middle !important;
            }

            .badge-tag {
                font-weight: 500;
                margin-bottom: .25rem;
            }

            .section-title {
                font-size: 1.05rem;
                font-weight: 700;
                color: #4e73df;
            }

            pre.recruitment-text {
                white-space: pre-wrap;
                font-family: inherit;
                font-size: .9rem;
                margin-bottom: 0;
            }
        </style>
    </th:block>
</head>

<body>
<section layout:fragment="content">

    <!-- Page Heading -->
    <div class="d-sm-flex align-items-center justify-content-between mb-3">
        <div>
            <h1 class="h3 mb-2 text-gray-800 d-flex align-items-center">
                <span class="badge badge-primary mr-2"
                      th:text="${recruitment.institution != null ? recruitment.institution.institutionName : '기관명 미등록'}">
                    기관명
                </span>
                <span th:text="${recruitment.title}">채용 공고 제목</span>
            </h1>
            <div class="text-muted small">
                <span class="mr-2">
                    <i class="far fa-calendar-alt mr-1"></i>
                    등록일:
                    <span th:text="${recruitment.regDate != null ?
                                    #temporals.format(recruitment.regDate, 'yyyy.MM.dd') : '-'}">
                        2025.01.01
                    </span>
                </span>
                <span class="mr-2">
                    <i class="far fa-calendar-times mr-1"></i>
                    마감일:
                    <span th:text="${recruitment.closeDate != null ?
                                    #temporals.format(recruitment.closeDate, 'yyyy.MM.dd') : '-'}">
                        2025.01.15
                    </span>
                </span>
                <span class="mr-2" th:if="${recruitment.recruitCount != null}">
                    <i class="fas fa-user-friends mr-1"></i>
                    채용인원:
                    <span th:text="${recruitment.recruitCount + '명'}">1명</span>
                </span>
            </div>
        </div>

        <div class="mt-3 mt-sm-0">
            <a class="btn btn-sm btn-secondary mr-2"
               th:href="@{/job-postings}">
                <i class="fas fa-arrow-left fa-sm mr-1"></i>
                목록으로
            </a>

            <!-- 북마크 / 기타 액션 버튼이 있다면 여기에 -->
            <button type="button" class="btn btn-sm btn-outline-primary"
                    data-toggle="tooltip" data-placement="bottom" title="관심 공고로 저장">
                <i class="far fa-bookmark mr-1"></i> 북마크
            </button>
        </div>
    </div>

    <!-- 공고 URL -->
    <div class="mb-4">
        <span class="font-weight-bold mr-2">공고 URL :</span>
        <a th:if="${recruitment.announcementUrl != null}"
           th:href="${recruitment.announcementUrl}"
           th:text="${recruitment.announcementUrl}"
           target="_blank"
           class="text-primary text-truncate d-inline-block"
           style="max-width: 500px;">
            www.sample.com
        </a>
        <span th:if="${recruitment.announcementUrl == null}" class="text-muted">
            등록된 공고 URL이 없습니다.
        </span>
    </div>

    <div class="row">
        <!-- 기본 정보 카드 -->
        <div class="col-lg-8 mb-4">
            <div class="card shadow-sm border-0">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <h6 class="m-0 font-weight-bold text-primary">기본 정보</h6>
                </div>
                <div class="card-body p-0">
                    <table class="table mb-0">
                        <tbody>
                        <tr>
                            <th>
                                <span class="dot-icon mr-2"></span> 기관명
                            </th>
                            <td th:text="${recruitment.institution != null ? recruitment.institution.institutionName : '-'}">
                                한국공공기관
                            </td>
                            <th>
                                <span class="dot-icon mr-2"></span> 채용구분
                            </th>
                            <td th:text="${recruitment.recruitType != null ? recruitment.recruitType.recruitTypeName : '-'}">
                                정규직 / 신입
                            </td>
                        </tr>

                        <tr>
                            <th>
                                <span class="dot-icon mr-2"></span> 고용형태
                            </th>
                            <td>
                                <span class="badge badge-light badge-tag mr-1"
                                      th:each="type : ${recruitment.employmentTypeList}"
                                      th:text="${type.employmentTypeName}">
                                    정규직
                                </span>
                                <span th:if="${#lists.isEmpty(recruitment.employmentTypeList)}" class="text-muted">
                                    -
                                </span>
                            </td>
                            <th>
                                <span class="dot-icon mr-2"></span> 대체인력여부
                            </th>
                            <td th:text="${recruitment.isReplacement != null ?
                                          (recruitment.isReplacement ? '예' : '아니오') : '-'}">
                                아니오
                            </td>
                        </tr>

                        <tr>
                            <th>
                                <span class="dot-icon mr-2"></span> 근무지
                            </th>
                            <td>
                                <span class="badge badge-light badge-tag mr-1"
                                      th:each="loc : ${recruitment.workLocation}"
                                      th:text="${loc.workLocationName}">
                                    서울
                                </span>
                                <span th:if="${#lists.isEmpty(recruitment.workLocation)}" class="text-muted">
                                    -
                                </span>
                            </td>
                            <th>
                                <span class="dot-icon mr-2"></span> 채용인원
                            </th>
                            <td th:text="${recruitment.recruitCount != null ?
                                          recruitment.recruitCount + '명' : '-'}">
                                1명
                            </td>
                        </tr>

                        <tr>
                            <th>
                                <span class="dot-icon mr-2"></span> 표준직무(NCS)
                            </th>
                            <td>
                                <span class="badge badge-light badge-tag mr-1"
                                      th:each="ncs : ${recruitment.ncsList}"
                                      th:text="${ncs.ncsName}">
                                    경영·사무
                                </span>
                                <span th:if="${#lists.isEmpty(recruitment.ncsList)}" class="text-muted">
                                    -
                                </span>
                            </td>
                            <th>
                                <span class="dot-icon mr-2"></span> 근무분야
                            </th>
                            <td>
                                <span class="badge badge-light badge-tag mr-1"
                                      th:each="field : ${recruitment.workFieldList}"
                                      th:text="${field.workFieldName}">
                                    시설직
                                </span>
                                <span th:if="${#lists.isEmpty(recruitment.workFieldList)}" class="text-muted">
                                    -
                                </span>
                            </td>
                        </tr>

                        <tr>
                            <th>
                                <span class="dot-icon mr-2"></span> 학력정보
                            </th>
                            <td>
                                <span class="badge badge-light badge-tag mr-1"
                                      th:each="edu : ${recruitment.educationLevelList}"
                                      th:text="${edu.educationLevelName}">
                                    학력무관
                                </span>
                                <span th:if="${#lists.isEmpty(recruitment.educationLevelList)}" class="text-muted">
                                    -
                                </span>
                            </td>
                            <th>
                                <span class="dot-icon mr-2"></span> 급여정보
                            </th>
                            <td>
                                <a class="btn btn-primary btn-sm"
                                   th:if="${recruitment.salaryInfoUrl != null}"
                                   th:href="${recruitment.salaryInfoUrl}"
                                   target="_blank">
                                    <span>상세보기</span>
                                    <i class="fas fa-search ml-1"></i>
                                </a>
                                <span th:if="${recruitment.salaryInfoUrl == null}" class="text-muted">
                                    별도 표기 없음
                                </span>
                            </td>
                        </tr>

                        <tr>
                            <th>
                                <span class="dot-icon mr-2"></span> 채용기간
                            </th>
                            <td>
                                <span th:text="${
                                         recruitment.regDate != null && recruitment.closeDate != null ?
                                         #temporals.format(recruitment.regDate, 'yy.MM.dd') + ' ~ ' +
                                         #temporals.format(recruitment.closeDate, 'yy.MM.dd') : '-'
                                     }">
                                    25.01.01 ~ 25.01.15
                                </span>
                            </td>
                            <th>
                                <span class="dot-icon mr-2"></span> 시스템 등록/수정
                            </th>
                            <td>
                                <div class="small text-muted">
                                    등록:
                                    <span th:text="${recruitment.createdAt != null ?
                                                   #temporals.format(recruitment.createdAt, 'yyyy.MM.dd HH:mm') : '-'}">
                                        2025.01.01 10:00
                                    </span>
                                </div>
                                <div class="small text-muted">
                                    수정:
                                    <span th:text="${recruitment.updatedAt != null ?
                                                   #temporals.format(recruitment.updatedAt, 'yyyy.MM.dd HH:mm') : '-'}">
                                        2025.01.02 11:30
                                    </span>
                                </div>
                            </td>
                        </tr>

                        <tr>
                            <th>
                                <span class="dot-icon mr-2"></span> 우대조건(요약)
                            </th>
                            <td colspan="3"
                                th:text="${recruitment.preferenceCondition != null ?
                                          recruitment.preferenceCondition : '-'}">
                                취업보호(지원)대상자, 장애인 등
                            </td>
                        </tr>

                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- 우측 요약 카드 -->
        <div class="col-lg-4 mb-4">
            <div class="card shadow-sm border-0 mb-3">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">공고 상태</h6>
                </div>
                <div class="card-body">
                    <div class="mb-2">
                        <span class="text-muted small d-block mb-1">
                            <i class="far fa-clock mr-1"></i> 마감까지
                        </span>
                        <!-- 남은 일수는 서버에서 계산해 넘겨주거나, 필요 없으면 제거 -->
<!--                        <span class="h5 mb-0 font-weight-bold text-gray-800"-->
<!--                              th:if="${daysLeft != null}"-->
<!--                              th:text="${daysLeft > 0 ? daysLeft + '일 남음' :-->
<!--                                       (daysLeft == 0 ? '오늘 마감' : '마감됨')}">-->
<!--                            5일 남음-->
<!--                        </span>-->
<!--                        <span class="h5 mb-0 font-weight-bold text-gray-800"-->
<!--                              th:if="${daysLeft == null}">-->
<!--                            - -->
<!--                        </span>-->
                    </div>

                    <hr>

                    <div class="mb-2">
                        <span class="text-muted small d-block mb-1">기관명</span>
                        <div class="font-weight-bold"
                             th:text="${recruitment.institution != null ? recruitment.institution.institutionName : '-'}">
                            한국공공기관
                        </div>
                    </div>

                    <div class="mb-2">
                        <span class="text-muted small d-block mb-1">고용형태</span>
                        <div>
                            <span class="badge badge-light badge-tag mr-1"
                                  th:each="type : ${recruitment.employmentTypeList}"
                                  th:text="${type.employmentTypeName}">
                                정규직
                            </span>
                            <span th:if="${#lists.isEmpty(recruitment.employmentTypeList)}" class="text-muted">
                                -
                            </span>
                        </div>
                    </div>

                    <div class="mb-2">
                        <span class="text-muted small d-block mb-1">근무지</span>
                        <div>
                            <span class="badge badge-light badge-tag mr-1"
                                  th:each="loc : ${recruitment.workLocation}"
                                  th:text="${loc.workLocationName}">
                                서울
                            </span>
                            <span th:if="${#lists.isEmpty(recruitment.workLocation)}" class="text-muted">
                                -
                            </span>
                        </div>
                    </div>

                    <div class="mb-2">
                        <span class="text-muted small d-block mb-1">표준직무(NCS)</span>
                        <div>
                            <span class="badge badge-light badge-tag mr-1"
                                  th:each="ncs : ${recruitment.ncsList}"
                                  th:text="${ncs.ncsName}">
                                경영·사무
                            </span>
                            <span th:if="${#lists.isEmpty(recruitment.ncsList)}" class="text-muted">
                                -
                            </span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- 필요시 추가 요약 카드들… -->
        </div>
    </div>

    <!-- 상세 내용 섹션들 -->
    <div class="row">
        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <span class="section-title">우대 사항 상세</span>
                    <i class="fas fa-info-circle text-gray-400"></i>
                </div>
                <div class="card-body">
                    <pre class="recruitment-text"
                         th:text="${recruitment.preferenceDetail != null ?
                                   recruitment.preferenceDetail : '등록된 우대 사항 상세가 없습니다.'}">
우대 사항 상세 내용
                    </pre>
                </div>
            </div>
        </div>

        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <span class="section-title">지원 자격</span>
                    <i class="fas fa-user-check text-gray-400"></i>
                </div>
                <div class="card-body">
                    <pre class="recruitment-text"
                         th:text="${recruitment.qualification != null ?
                                   recruitment.qualification : '등록된 지원 자격 정보가 없습니다.'}">
지원 자격 내용
                    </pre>
                </div>
            </div>
        </div>

        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <span class="section-title">결격 사유</span>
                    <i class="fas fa-user-times text-gray-400"></i>
                </div>
                <div class="card-body">
                    <pre class="recruitment-text"
                         th:text="${recruitment.disqualification != null ?
                                   recruitment.disqualification : '등록된 결격 사유 정보가 없습니다.'}">
결격 사유 내용
                    </pre>
                </div>
            </div>
        </div>

        <div class="col-lg-6 mb-4">
            <div class="card shadow-sm border-0 h-100">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <span class="section-title">전형 절차</span>
                    <i class="fas fa-stream text-gray-400"></i>
                </div>
                <div class="card-body">
                    <pre class="recruitment-text"
                         th:text="${recruitment.selectionProcess != null ?
                                   recruitment.selectionProcess : '등록된 전형 절차 정보가 없습니다.'}">
전형 절차 내용
                    </pre>
                </div>
            </div>
        </div>
    </div>

    <!-- 단계별 전형 정보가 있다면 별도 표로 표시 -->
    <div class="row" th:if="${recruitment.selectionStages != null and !#lists.isEmpty(recruitment.selectionStages)}">
        <div class="col-12 mb-4">
            <div class="card shadow-sm border-0">
                <div class="card-header py-3 d-flex justify-content-between align-items-center">
                    <span class="section-title">단계별 전형 정보</span>
                    <i class="fas fa-list-ol text-gray-400"></i>
                </div>
                <div class="card-body p-0">
                    <table class="table mb-0">
                        <thead class="thead-light">
                        <tr>
                            <th>전형구분</th>
                            <th>선발인원</th>
                            <th>응시인원</th>
                            <th>결과 확정일</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr th:each="stage, iter : ${recruitment.selectionStages}">
                            <!-- SelectionStage 엔티티 필드명에 맞게 수정해서 사용하세요 -->
                            <td th:text="${stage.selectionStageType != null ? stage.selectionStageType.selectionStageTypeName : '-'}">서류전형</td>
                            <td th:text="${stage.selectedCount != null ? stage.selectedCount : '-'}"></td>
                            <td th:text="${stage.applicantCount != null ? stage.applicantCount : '-'}"></td>
                            <td th:text="${stage.resultConfirmDate != null ? stage.resultConfirmDate : '-'}"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

</section>

<th:block layout:fragment="script-extra">
    <script th:inline="javascript">
        /*<![CDATA[*/
        $(function () {
            // tooltip 초기화 (상단 scripts fragment에서 global init 되어 있으므로 선택적으로 사용)
        });
        /*]]>*/
    </script>
</th:block>
</body>
</html>